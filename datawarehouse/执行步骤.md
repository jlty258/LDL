# åˆ¶é€ ä¸šæ•°ä»“é¡¹ç›®æ‰§è¡Œæ­¥éª¤

## âœ… å·²å®Œæˆ

### 1. æ•°æ®åº“è¡¨ç»“æ„åˆ›å»º âœ“
- ODSå±‚ï¼š30å¼ è¡¨
- DWDå±‚ï¼š10å¼ è¡¨  
- DWSå±‚ï¼š7å¼ è¡¨
- ADSå±‚ï¼š8å¼ è¡¨

éªŒè¯å‘½ä»¤ï¼š
```bash
docker exec mysql-db mysql -u sqluser -psqlpass123 sqlExpert -e "SELECT 'ODS' as layer, COUNT(*) as count FROM information_schema.tables WHERE table_schema = 'sqlExpert' AND table_name LIKE 'ods_%' UNION ALL SELECT 'DWD', COUNT(*) FROM information_schema.tables WHERE table_schema = 'sqlExpert' AND table_name LIKE 'dwd_%' UNION ALL SELECT 'DWS', COUNT(*) FROM information_schema.tables WHERE table_schema = 'sqlExpert' AND table_name LIKE 'dws_%' UNION ALL SELECT 'ADS', COUNT(*) FROM information_schema.tables WHERE table_schema = 'sqlExpert' AND table_name LIKE 'ads_%';"
```

## ğŸ“‹ å¾…æ‰§è¡Œæ­¥éª¤

### 2. ç”Ÿæˆæµ‹è¯•æ•°æ®

éœ€è¦Pythonç¯å¢ƒï¼ˆéœ€è¦å®‰è£…mysql-connector-pythonï¼‰ï¼š
```bash
pip install mysql-connector-python
python datawarehouse/sql/06_generate_test_data.py
```

æˆ–è€…ä½¿ç”¨Dockeræ‰§è¡Œï¼š
```bash
# å°†è„šæœ¬å¤åˆ¶åˆ°å®¹å™¨
docker cp datawarehouse/sql/06_generate_test_data.py mysql-db:/tmp/
docker exec -it mysql-db bash
# åœ¨å®¹å™¨å†…å®‰è£…Pythonä¾èµ–å¹¶æ‰§è¡Œ
```

**é¢„æœŸç»“æœ**ï¼š
- ods_material_master: 10000è¡Œï¼ˆæœ€å¤§è¡¨ï¼‰
- å…¶ä»–è¡¨ï¼šç›¸åº”æ•°é‡çš„æµ‹è¯•æ•°æ®

### 3. åˆ›å»ºAirflow DAGä»»åŠ¡

**æ–¹æ³•1ï¼šä½¿ç”¨Pythonè„šæœ¬ç”Ÿæˆï¼ˆæ¨èï¼‰**
```bash
python datawarehouse/scripts/create_all_dags.py
```

**æ–¹æ³•2ï¼šæ‰‹åŠ¨åˆ›å»º**
DAGæ–‡ä»¶æ¨¡æ¿å·²åˆ›å»ºåœ¨ `airflow/dags/ods_01_order_master_etl.py`ï¼Œå¯ä»¥å¤åˆ¶å¹¶ä¿®æ”¹åˆ›å»ºå…¶ä»–29ä¸ªDAGã€‚

**éªŒè¯**ï¼š
```bash
# æ£€æŸ¥Airflow DAGç›®å½•
ls airflow/dags/*.py
# åº”è¯¥çœ‹åˆ°30ä¸ªDAGæ–‡ä»¶
```

### 4. åˆ›å»ºDolphinSchedulerä»»åŠ¡

**å‰æ**ï¼šç¡®ä¿DolphinScheduleræœåŠ¡è¿è¡Œ
```bash
# æ£€æŸ¥æœåŠ¡
docker ps | grep dolphinscheduler

# åˆ›å»ºä»»åŠ¡
python datawarehouse/schedulers/create_dolphinscheduler_tasks.py
```

**è®¿é—®DolphinScheduler**ï¼š
- URL: http://localhost:12345
- ç”¨æˆ·å: admin
- å¯†ç : dolphinscheduler123

### 5. æ‰§è¡ŒETLä»»åŠ¡

**æ‰§è¡Œå¤æ‚ETL SQL**ï¼š
```bash
docker cp datawarehouse/sql/07_complex_etl.sql mysql-db:/tmp/
docker exec mysql-db mysql -u sqluser -psqlpass123 sqlExpert -e "source /tmp/07_complex_etl.sql"
```

**éªŒè¯ETLç»“æœ**ï¼š
```bash
# æ£€æŸ¥DWDå±‚æ•°æ®
docker exec mysql-db mysql -u sqluser -psqlpass123 sqlExpert -e "SELECT COUNT(*) FROM dwd_order_fact;"

# æ£€æŸ¥DWSå±‚æ•°æ®
docker exec mysql-db mysql -u sqluser -psqlpass123 sqlExpert -e "SELECT COUNT(*) FROM dws_order_daily;"

# æ£€æŸ¥ADSå±‚æ•°æ®
docker exec mysql-db mysql -u sqluser -psqlpass123 sqlExpert -e "SELECT COUNT(*) FROM ads_sales_analysis;"
```

## ğŸ¯ å¿«é€ŸéªŒè¯æ¸…å•

- [x] æ•°æ®åº“è¡¨ç»“æ„åˆ›å»ºï¼ˆ55å¼ è¡¨ï¼‰
- [ ] æµ‹è¯•æ•°æ®ç”Ÿæˆï¼ˆods_material_master: 10000è¡Œï¼‰
- [ ] Airflow DAGæ–‡ä»¶åˆ›å»ºï¼ˆ30ä¸ªï¼‰
- [ ] DolphinSchedulerä»»åŠ¡åˆ›å»ºï¼ˆ30ä¸ªï¼‰
- [ ] ETLä»»åŠ¡æ‰§è¡ŒæˆåŠŸ
- [ ] è°ƒåº¦ä»»åŠ¡è¿è¡ŒæˆåŠŸ

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **ODSå±‚è¡¨**: 30å¼ 
- **DWDå±‚è¡¨**: 10å¼ 
- **DWSå±‚è¡¨**: 7å¼ 
- **ADSå±‚è¡¨**: 8å¼ 
- **è°ƒåº¦ä»»åŠ¡**: 30ä¸ªï¼ˆAirflow + DolphinSchedulerï¼‰
- **æœ€å¤§è¡¨æ•°æ®é‡**: 10000è¡Œ
- **å¤æ‚ETL SQL**: è¶…è¿‡100è¡Œï¼ˆ636è¡Œï¼‰

## ğŸ”§ æ•…éšœæ’æŸ¥

### Pythonå‘½ä»¤ä¸å¯ç”¨
å¦‚æœç³»ç»Ÿæ²¡æœ‰Pythonï¼Œå¯ä»¥ï¼š
1. å®‰è£…Python 3.x
2. ä½¿ç”¨Dockerå®¹å™¨æ‰§è¡ŒPythonè„šæœ¬
3. æ‰‹åŠ¨æ‰§è¡ŒSQLå’Œåˆ›å»ºDAGæ–‡ä»¶

### æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥MySQLå®¹å™¨çŠ¶æ€
docker ps | grep mysql-db

# æµ‹è¯•è¿æ¥
docker exec mysql-db mysql -u sqluser -psqlpass123 -e "SELECT 1;"
```

### Airflow DAGä¸æ˜¾ç¤º
1. æ£€æŸ¥DAGæ–‡ä»¶è¯­æ³•
2. æ£€æŸ¥Airflowæ—¥å¿—
3. ç¡®ä¿DAGæ–‡ä»¶åœ¨æ­£ç¡®ç›®å½•ï¼š`airflow/dags/`

### DolphinSchedulerä»»åŠ¡åˆ›å»ºå¤±è´¥
1. æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥REST APIè¿æ¥
3. æŸ¥çœ‹DolphinScheduleræ—¥å¿—
