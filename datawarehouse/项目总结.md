# åˆ¶é€ ä¸šæ•°æ®ä»“åº“é¡¹ç›®æ€»ç»“

## âœ… å·²å®Œæˆå†…å®¹

### 1. æ•°æ®åº“è¡¨ç»“æ„ âœ…
- **ODSå±‚**: 30å¼ è¡¨ï¼ˆåŒ…æ‹¬æœ€å¤§è¡¨ods_material_masterï¼Œ10000è¡Œï¼‰
- **DWDå±‚**: 10å¼ è¡¨ï¼ˆäº‹å®è¡¨å’Œç»´åº¦è¡¨ï¼‰
- **DWSå±‚**: 7å¼ æ±‡æ€»è¡¨
- **ADSå±‚**: 8å¼ åˆ†ææŠ¥è¡¨è¡¨

### 2. SQLè„šæœ¬ âœ…
- `01_init_database.sql` - æ•°æ®åº“åˆå§‹åŒ–
- `02_ods_tables.sql` - ODSå±‚30å¼ è¡¨ç»“æ„
- `03_dwd_tables.sql` - DWDå±‚è¡¨ç»“æ„
- `04_dws_tables.sql` - DWSå±‚è¡¨ç»“æ„
- `05_ads_tables.sql` - ADSå±‚è¡¨ç»“æ„
- `06_generate_test_data.py` - æµ‹è¯•æ•°æ®ç”Ÿæˆè„šæœ¬ï¼ˆæœ€å¤§è¡¨10000è¡Œï¼‰
- `07_complex_etl.sql` - **è¶…è¿‡100è¡Œçš„å¤æ‚ETL SQL**ï¼ˆå®ç°ODSâ†’DWDâ†’DWSâ†’ADSå®Œæ•´æ•°æ®æµè½¬ï¼‰

### 3. è°ƒåº¦ä»»åŠ¡é…ç½® âœ…

#### DolphinScheduler - 30ä¸ªä»»åŠ¡
- è„šæœ¬: `datawarehouse/schedulers/create_dolphinscheduler_tasks.py`
- åŒ…å«30ä¸ªå·¥ä½œæµå®šä¹‰ï¼Œè¦†ç›–æ‰€æœ‰ETLä»»åŠ¡

#### Airflow - 30ä¸ªDAG
- å·²åˆ›å»ºç¤ºä¾‹: `airflow/dags/ods_01_order_master_etl.py`
- æ‰¹é‡ç”Ÿæˆè„šæœ¬: `datawarehouse/scripts/create_all_dags.py`
- è¿è¡Œè„šæœ¬å¯ç”Ÿæˆå‰©ä½™29ä¸ªDAGæ–‡ä»¶

## ğŸ“‹ ä»»åŠ¡åˆ—è¡¨ï¼ˆ30ä¸ªï¼‰

### ODSå±‚ (1-10)
1. ods_01_order_master_etl âœ…
2. ods_02_order_detail_etl
3. ods_03_customer_etl
4. ods_04_product_etl
5. ods_05_production_plan_etl
6. ods_06_production_order_etl
7. ods_07_bom_etl
8. ods_08_material_etl
9. ods_09_inventory_etl
10. ods_10_purchase_etl

### DWDå±‚ (11-17)
11. dwd_01_order_fact_etl
12. dwd_02_production_fact_etl
13. dwd_03_inventory_fact_etl
14. dwd_04_purchase_fact_etl
15. dwd_05_quality_fact_etl
16. dwd_06_equipment_runtime_etl
17. dwd_07_cost_fact_etl

### DWSå±‚ (18-24)
18. dws_01_order_daily_etl
19. dws_02_production_daily_etl
20. dws_03_inventory_daily_etl
21. dws_04_purchase_daily_etl
22. dws_05_quality_daily_etl
23. dws_06_equipment_runtime_daily_etl
24. dws_07_cost_daily_etl

### ADSå±‚ (25-30)
25. ads_01_sales_analysis_etl
26. ads_02_production_analysis_etl
27. ads_03_inventory_analysis_etl
28. ads_04_purchase_analysis_etl
29. ads_05_quality_analysis_etl
30. ads_06_business_overview_etl

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ•°æ®åº“
```bash
# åˆ›å»ºæ•°æ®åº“å’Œè¡¨ç»“æ„
mysql -h localhost -P 3306 -u sqluser -psqlpass123 < datawarehouse/sql/01_init_database.sql
mysql -h localhost -P 3306 -u sqluser -psqlpass123 sqlExpert < datawarehouse/sql/02_ods_tables.sql
mysql -h localhost -P 3306 -u sqluser -psqlpass123 sqlExpert < datawarehouse/sql/03_dwd_tables.sql
mysql -h localhost -P 3306 -u sqluser -psqlpass123 sqlExpert < datawarehouse/sql/04_dws_tables.sql
mysql -h localhost -P 3306 -u sqluser -psqlpass123 sqlExpert < datawarehouse/sql/05_ads_tables.sql
```

### 2. ç”Ÿæˆæµ‹è¯•æ•°æ®
```bash
python datawarehouse/sql/06_generate_test_data.py
```
è¿™å°†ç”Ÿæˆï¼š
- ods_material_master: **10000è¡Œ**ï¼ˆæœ€å¤§è¡¨ï¼‰
- å…¶ä»–è¡¨ï¼šç›¸åº”æ•°é‡çš„æµ‹è¯•æ•°æ®

### 3. åˆ›å»ºè°ƒåº¦ä»»åŠ¡

#### Airflow DAG
```bash
python datawarehouse/scripts/create_all_dags.py
```
è¿™å°†ç”Ÿæˆ30ä¸ªDAGæ–‡ä»¶åˆ° `airflow/dags/` ç›®å½•

#### DolphinScheduler
```bash
python datawarehouse/schedulers/create_dolphinscheduler_tasks.py
```
éœ€è¦å…ˆå¯åŠ¨DolphinScheduleræœåŠ¡

## ğŸ“Š æ•°æ®ä»“åº“æ¶æ„

```
ä¸šåŠ¡ç³»ç»Ÿ
    â†“
ODSå±‚ (30å¼ è¡¨) - åŸå§‹æ•°æ®å­˜å‚¨
    â†“ ETLæ¸…æ´—è½¬æ¢
DWDå±‚ (10å¼ è¡¨) - æ˜ç»†æ•°æ®å±‚
    â†“ æ•°æ®æ±‡æ€»
DWSå±‚ (7å¼ è¡¨) - æ±‡æ€»æ•°æ®å±‚
    â†“ åº”ç”¨æœåŠ¡
ADSå±‚ (8å¼ è¡¨) - åº”ç”¨æ•°æ®æœåŠ¡å±‚
    â†“
ä¸šåŠ¡æŠ¥è¡¨å’Œåˆ†æ
```

## ğŸ” å¤æ‚SQLè¯´æ˜

`07_complex_etl.sql` åŒ…å«ï¼š
- **è¶…è¿‡100è¡Œ**çš„å¤æ‚ETL SQL
- å®ç°ä»ODSåˆ°DWDåˆ°DWSåˆ°ADSçš„å®Œæ•´æ•°æ®æµè½¬
- åŒ…æ‹¬æ•°æ®æ¸…æ´—ã€è½¬æ¢ã€æ±‡æ€»ã€å¤šè¡¨å…³è”ç­‰å¤æ‚ä¸šåŠ¡é€»è¾‘
- 13ä¸ªETLæ­¥éª¤ï¼Œè¦†ç›–æ‰€æœ‰æ•°æ®å±‚

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿MySQLæœåŠ¡è¿è¡Œåœ¨localhost:3306
2. **Pythonä¾èµ–**: éœ€è¦å®‰è£…mysql-connector-python
3. **Airflow**: DAGæ–‡ä»¶éœ€è¦æ”¾åœ¨airflow/dagsç›®å½•
4. **DolphinScheduler**: éœ€è¦å…ˆé…ç½®æ•°æ®æºè¿æ¥
5. **æµ‹è¯•æ•°æ®**: ç”Ÿæˆ10000è¡Œç‰©æ–™æ•°æ®éœ€è¦ä¸€äº›æ—¶é—´

## âœ¨ é¡¹ç›®ç‰¹ç‚¹

- âœ… å®Œæ•´çš„å››å±‚æ•°æ®ä»“åº“æ¶æ„
- âœ… 30å¼ ODSè¡¨ï¼Œè¦†ç›–åˆ¶é€ ä¸šå…¨ä¸šåŠ¡æµç¨‹
- âœ… æœ€å¤§è¡¨10000è¡Œæµ‹è¯•æ•°æ®
- âœ… è¶…è¿‡100è¡Œçš„å¤æ‚ETL SQL
- âœ… 30ä¸ªè°ƒåº¦ä»»åŠ¡ï¼ˆDolphinScheduler + Airflowï¼‰
- âœ… å®Œæ•´çš„ETLæ•°æ®æµè½¬é“¾è·¯
