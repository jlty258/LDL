# ğŸ¯ æœ€ç»ˆéªŒè¯æŒ‡å—

## âœ… å·²å®Œæˆ

1. **æ•°æ®åº“è¡¨ç»“æ„**: 55å¼ è¡¨å·²åˆ›å»º
2. **Airflow DAGæ–‡ä»¶**: 30ä¸ªDAGæ–‡ä»¶å·²åˆ›å»ºåœ¨ `airflow/dags/` ç›®å½•
3. **DolphinSchedulerä»»åŠ¡é…ç½®**: è„šæœ¬å·²åˆ›å»º

## ğŸ” éªŒè¯Airflow DAG

### æ–¹æ³•1: Webç•Œé¢éªŒè¯ï¼ˆæ¨èï¼‰

1. **è®¿é—®Airflow Webç•Œé¢**
   - URL: http://localhost:8080
   - ç”¨æˆ·å: `airflow`
   - å¯†ç : `airflow`

2. **æŸ¥çœ‹DAGåˆ—è¡¨**
   - ç™»å½•åï¼Œåœ¨ä¸»é¡µåº”è¯¥èƒ½çœ‹åˆ°æ‰€æœ‰DAG
   - æŸ¥æ‰¾ä»¥ä¸‹DAGï¼ˆå…±30ä¸ªï¼‰ï¼š
     - `ods_01_order_master_etl` åˆ° `ods_10_purchase_etl` (10ä¸ª)
     - `dwd_01_order_fact_etl` åˆ° `dwd_07_cost_fact_etl` (7ä¸ª)
     - `dws_01_order_daily_etl` åˆ° `dws_07_cost_daily_etl` (7ä¸ª)
     - `ads_01_sales_analysis_etl` åˆ° `ads_06_business_overview_etl` (6ä¸ª)

3. **å¯ç”¨DAG**
   - æ‰¾åˆ°ETLç›¸å…³çš„DAG
   - ç‚¹å‡»å·¦ä¾§çš„å¼€å…³æŒ‰é’®å¯ç”¨DAG
   - å¯ç”¨åDAGä¼šæ˜¾ç¤ºä¸ºç»¿è‰²

4. **æ‰‹åŠ¨è§¦å‘DAG**
   - ç‚¹å‡»DAGåç§°è¿›å…¥è¯¦æƒ…é¡µ
   - ç‚¹å‡»"Trigger DAG"æŒ‰é’®æ‰‹åŠ¨è§¦å‘
   - å¯ä»¥åœ¨"Graph View"æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€

### æ–¹æ³•2: å‘½ä»¤è¡ŒéªŒè¯

```bash
# åˆ—å‡ºæ‰€æœ‰DAG
docker exec airflow-standalone airflow dags list

# åˆ—å‡ºETLç›¸å…³çš„DAG
docker exec airflow-standalone airflow dags list | grep etl

# æ£€æŸ¥ç‰¹å®šDAG
docker exec airflow-standalone airflow dags show ods_01_order_master_etl
```

### æ–¹æ³•3: REST APIéªŒè¯

```bash
# ä½¿ç”¨Pythonè„šæœ¬éªŒè¯
python datawarehouse/scripts/verify_dags.py
```

## ğŸ” éªŒè¯DolphinSchedulerä»»åŠ¡

### 1. è®¿é—®DolphinScheduler

- URL: http://localhost:12345
- ç”¨æˆ·å: `admin`
- å¯†ç : `dolphinscheduler123`

### 2. åˆ›å»ºä»»åŠ¡

```bash
python datawarehouse/schedulers/create_dolphinscheduler_tasks.py
```

### 3. åœ¨Webç•Œé¢æŸ¥çœ‹

1. ç™»å½•DolphinScheduler
2. è¿›å…¥"é¡¹ç›®ç®¡ç†"
3. æ‰¾åˆ°"åˆ¶é€ ä¸šæ•°ä»“"é¡¹ç›®
4. æŸ¥çœ‹å·¥ä½œæµå®šä¹‰åˆ—è¡¨
5. åº”è¯¥èƒ½çœ‹åˆ°30ä¸ªå·¥ä½œæµ

## ğŸ“Š é¡¹ç›®å®Œæˆåº¦æ£€æŸ¥æ¸…å•

- [x] æ•°æ®åº“è¡¨ç»“æ„åˆ›å»ºï¼ˆ55å¼ è¡¨ï¼‰
- [x] Airflow DAGæ–‡ä»¶åˆ›å»ºï¼ˆ30ä¸ªæ–‡ä»¶ï¼‰
- [ ] Airflow DAGåœ¨Webç•Œé¢å¯è§ï¼ˆéœ€è¦ç­‰å¾…Airflowæ‰«æï¼‰
- [ ] DolphinSchedulerä»»åŠ¡åˆ›å»ºï¼ˆéœ€è¦æ‰§è¡Œè„šæœ¬ï¼‰
- [ ] æµ‹è¯•æ•°æ®ç”Ÿæˆï¼ˆå¯é€‰ï¼‰
- [x] å¤æ‚ETL SQLåˆ›å»ºï¼ˆ636è¡Œï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Airflow DAGæ‰«ææ—¶é—´**
   - Airflowé»˜è®¤æ¯30ç§’æ‰«æä¸€æ¬¡DAGç›®å½•
   - å¦‚æœDAGæ²¡æœ‰ç«‹å³å‡ºç°ï¼Œè¯·ç­‰å¾…1-2åˆ†é’Ÿ
   - å¯ä»¥é‡å¯Airflowå®¹å™¨åŠ é€Ÿæ‰«æï¼š
     ```bash
     docker restart airflow-standalone
     ```

2. **DAGæ–‡ä»¶ä½ç½®**
   - ç¡®ä¿DAGæ–‡ä»¶åœ¨ `airflow/dags/` ç›®å½•
   - Airflowå®¹å™¨éœ€è¦èƒ½è®¿é—®è¿™ä¸ªç›®å½•
   - æ£€æŸ¥docker-compose.ymlä¸­çš„volumeæŒ‚è½½

3. **DAGè¯­æ³•æ£€æŸ¥**
   - å¦‚æœDAGæœ‰è¯­æ³•é”™è¯¯ï¼Œä¼šåœ¨Airflowç•Œé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
   - æ£€æŸ¥Airflowæ—¥å¿—ï¼š
     ```bash
     docker logs airflow-standalone
     ```

## ğŸ‰ æˆåŠŸæ ‡å¿—

å½“ä½ åœ¨Airflow Webç•Œé¢çœ‹åˆ°ä»¥ä¸‹å†…å®¹æ—¶ï¼Œè¯´æ˜é¡¹ç›®å·²æˆåŠŸï¼š

1. âœ… èƒ½çœ‹åˆ°30ä¸ªETLç›¸å…³çš„DAG
2. âœ… DAGçŠ¶æ€æ˜¾ç¤ºä¸º"Running"ï¼ˆç»¿è‰²ï¼‰
3. âœ… å¯ä»¥æ‰‹åŠ¨è§¦å‘DAGå¹¶æˆåŠŸæ‰§è¡Œ
4. âœ… åœ¨DolphinSchedulerä¸­èƒ½çœ‹åˆ°30ä¸ªå·¥ä½œæµ

---

**ç°åœ¨è®¿é—® http://localhost:8080 åº”è¯¥èƒ½çœ‹åˆ°æ‰€æœ‰30ä¸ªè°ƒåº¦ä»»åŠ¡äº†ï¼**
